# Прогнозирование оттока клиентов в Телекоме

Данные: [Telco Customer Churn](https://www.kaggle.com/datasets/blastchar/telco-customer-churn)

### Цель проекта
Разработать систему раннего обнаружения клиентов, склонных к уходу, и рассчитать экономический эффект
от внедрения модели удержания. Основной акцент сделан на максимизацию прибыли за счет точного выявления
сегментов с высоким риском и высоким LTV.
---
## Ключевые инсайты (EDA)
В ходе исследовательского анализа были выявлены критические точки оттока:
- **Критический период:** Клиенты наиболее склонны к уходу в первые 6 месяцев.
- **Тип контракта:** Помесячная оплата является главным драйвером оттока, в то время 
- как двухлетние контракты практически гарантируют лояльность.
- **Технологический риск:** Пользователи оптоволоконного интернета уходят чаще, что может
- указывать на проблемы с качеством или ценообразованием в этом сегменте.
- **Сила сервисов:** Каждая дополнительная подключенная услуга значительно снижает вероятность ухода.
---
## Технологический стек и подходы
Для обеспечения надежности и чистоты кода были использованы профессиональные практики:
- **scikit-learn Pipelines:** Весь процесс обработки данных (scaling, encoding, feature engineering) объединены в единый пайплайн. Это гарантирует отсутствие утечки данных и простоту деплоя.
- **Custom Transformers:** Создан собственный класс TelecomFeatureEngineering для автоматического создания признаков:
  - ```Total_Services```: Индекс вовлеченности клиента
  - ```is_new_client```: Бинарный признак критического периода (до 6 мес).
- **Linear Model:** Использование логистической регрессии обеспечило высокую интерпретируемость - бизнес может точно видеть, какие рычаги влияют на решение клиента.
---
## Результаты моделирования
Модель оптимизирована под метрику Recall, т.к., для бизнеса цена пропуска клиента выше, чем цена ложной тревоги.
- **ROC-AUC:** 0.835 (стабильное разделение классов)
- **Recall:** 0.77 (мы находим 77% всех уходящих клиентов).
- **F1-score:** 0.6
---
## Экономический эффект
На основе данных о среднем чеке и сроки жизни
клиентов был рассчитан реальный профит:

**Параметры расчета:**
- **LTV:** $1164.36 (на основе исторических данных)
- **Retention Cost:** $29.11 (2.5% от LTV - стоимость скидки или бонуса).
- **P_success:** 0.7 (вероятность того, что клиент останется после оффера)

**Формула прибыли:**

$$ Profit = (TP * P_{success} * LTV) - (TP + FP) * Cost_{retention} $$

**Итог на тестовой выборке:**
- **Чистая прибыль:** +$217,560.
- **Спасенная выручка:** $234,735.
- **Предотвращенные убытки:** Модель позволяет избежать потери основной части выручки, подверженной риску оттока.
---
## Рекомендации для бизнеса
1. **Фокус на "Новичков":** Усилить отдел заботы в первые 6 месяцев жизни клиента.
2. **Конверсия в пакеты:** Стимулировать подключение дополнительных услуг, так как это самый дешевый способ удержания.
3. **Ревизия Fiber Optic:** Провести технический аудит качества связи сегменте  оптоволокна, так как это точка максимальной потери выручки.
---
## Структура репозитория
- ``01_eda.ipynb``: Исследование данных и расчет LTV.
- ``02_model.ipynb``: Создание пайплайна, обучение и финансовый расчёт.
- ``results/``: Графики и матрицы ошибок.
- ``requirements.txt``: Список зависимостей для воспроизведения.
---
### Как запустить
```bash
git clone https://github.com/Mzulliev/customer-churn-prediction.git
pip install -r requirements.txt
jupyter notebook
```

